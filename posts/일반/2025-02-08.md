# numpy, matplotlib, pandas


## numpy

### 행렬 생성
```fill100
import numpy as np

a = np.array([1,2,3])  # 일차원 행렬
b = np.array([[1,2],[3,4]]) # 2차원 행렬
c = np.array([1,2,3,4,5], ndmin=2)  # 최소 행렬 차원 지정
d = np.array([1,2,3], dtype=float)  # 행렬 데이터 타입 지정


a = np.arange(5)
b = np.arange(3, 9, 2)  # 3에서 9까지 2씩 증가하며
c = np.zeros(5)         # 0이 5개 있는 행렬
d = np.ones(5)          # 1이 5개 있는 행렬
print(a)

a = np.eye(3)       # 3*3 항등행렬 생성
b = np.eye(3,4)     # 3*4 항등행렬 생성
c = np.linspace(10, 20, 5)  # 10에서 20까지, 거리가 같은 5개의 원소를 가진 행렬을 생성

```
- ndarray형 생성: 행렬을 나타내는 자료구조


### 행렬 변환

```fill100
a = np.arange(6)
print(a)
b = a.reshape(3, 2)
c = b.reshape(2, 3)
print(b)
print(b[2,1])
print(b[:, 1])
print(c)
print(np.shape(b))
print(np.size(b))
print(np.ndim(b))
print(np.transpose(b))

c = np.copy(b)
print(c)
print(np.ravel(c))  # 행렬을 일차원 행렬로 변환
```


### 행렬의 연산

```fill100
a = np.array([[1,2],[3,4]])
b = np.array([[11,12], [13, 14]])

print(a + b)        # 행렬 합
print(a * b)        # 원소별 곱
print(np.dot(a, b)) # 행렬곱(외적)
print(np.inner(a, b)) # 내적
# [[1,2]dot[11,12], [1,2]dot[13,14]]
# [[3,4]dot[11,12], [3,4]dot[13,14]]
```

```fill100
a = np.random.rand(5)
b = np.around(a, decimals=3)
c = np.floor(a)
d = np.ceil(a)
```

```fill100
a = np.array([[3, 7, 5], [8, 4, 3], [2, 4, 9]])
b = np.amin(a, 1)  # 각 행별 최소값
c = np.amin(a, 0)  # 각 열별 최대값
d = np.amin(a)     # 전체 행렬에서 최대값
e = np.amax(a, 1)  # 각 행별 최대값
f = np.amax(a, 0)  # 각 열별 최대값
```

```fill100
a = np.array([1,2,3,4])
b = np.average(a)
c = np.std(a)
d = np.var(a)
```
- 난수 생성
  - rand: uniform distribution, [0,1)
  - randint: uniform distribution, 정수 [a,b)

```fill100
b = np.random.rand(3,2)
c = np.random.randint(3, 9, size=(2,4))
```

### 선형대수

```fill100
a = np.array([[1,2], [3,4]])
b = np.array([[-4], [1]])
inv_a = np.linalg.inv(a)   # 역행렬 계산
c = np.linalg.solve(a, b)  # ax = b의 x 계산
d = np.linalg.det(a)       # a의 행렬식 계산
e = np.linalg.eig(a)       # a의 고유값, 고유벡터 계산
```

## matplotlib
### 1. 쥐 & 고양이 그래프
```fill100
from matplotlib import pyplot as plt

plt.plot([1,2,3],[1,4,9])
plt.plot([2,3,4], [5,6,7])
plt.xlabel('Sequence')
plt.ylabel('Time(sec)')
plt.title('Experimental Result')
plt.legend(['Mouse', 'Cat'])
plt.show()
```

<img src="./assets/images/대문.AI프로그래밍.pyplot-ex1.jpg" width="350px">


### 2. 가우시안 함수 그래프

```fill100
aussian = lambda x : np.exp(-(0.5 - x)**2/1.5)

x = np.arange(-2.5, 2.5, 0.01)
y = gaussian(x)

plt.plot(x,y)
plt.xlabel('x values')
plt.ylabel('exp(-(0.5-x)**2/1.5)')
plt.title('Gaussian Function')
plt.show()
```

<img src="./assets/images/대문.AI프로그래밍.pyplot-ex2.jpg" width="350px">

## pandas
### Series 형과 DataFrame형
```fill100
import pandas as pd

ser = pd.Series(data=[1,2,3], index=['a', 'b', 'c'])
print(ser['a'])
d = {'col1':[1,2], 'col2':[3,4]}
df = pd.DataFrame(data=d)
print(df)
```
- DataFrame의 열 1개는 Series로 구성되어 있다.

### 파일 읽어오기 & 저장하기
```fill100
iris = pd.read_csv('https://raw.githubusercontent.com/mwaskom/seaborn-data/master/iris.csv')
print(iris)
iris.to_excel('iris.xlsx')
```

### DataFrame 인덱싱

```fill100
iris['sepal_length']  # 열을 선택
iris.sepal_length     # 위와 같은 결과
iris[['sepal_length', 'species']]  # 열 여러 개 선택
```

```fill100
iris.loc[2:3, ['sepal_length', 'species']]
# DataFrame().loc[2:3,] 에서 2:3은 일반적인 슬라이싱과는 다르게
# 인덱스 2와 3을 모두 포함한다.
```
- 결과

|....|sepal_length	|species|
| - | - | - |
| 2	|4.7	|setosa|
|3	|4.6	|setosa|

```fill100
iris.loc[2, 'sepal_length']
iris.at[2, 'sepal_length'] # 스칼라값(값 1개) 빠른 접근
```

```fill100
iris.iloc[2:3, 3:5] # 열을 숫자 인덱스로 취급해 접근
iris.iat[2,3]  # 더 빠른 접근법
```

- boolean indexing
  - 특정 조건을 충족하는 값을 찾는 유용한 방법
  - `iris['sepal_length'] > 7.0` : 해당 Series나 DataFrame에서 값을 비교해 True와 False로 이루어진 Series나 DataFrame을 반환할 것이다.
```fill100
iris[iris['sepal_length'] > 7.0]
iris[(iris['sepal_length'] > 7.0) & (iris['sepal_width'] > 3.5)]
```

### 수리연산
element-wise한 수리연산(합, 차, 곱, 나누기)

```fill100
ser = iris['sepal_length']
ser * 2

df = iris[['sepal_width', 'sepal_length']]
df * 2
```

### 통계연산

```fill100
iris['sepal_length'].mean()
iris[['sepal_width', 'sepal_length']].mean()
iris[['sepal_width', 'sepal_length']].describe()
```
- iris[['sepal_width', 'sepal_length']].describe()의 결과

|	|sepal_width	|sepal_length|
| - | - | - |
|count	|150.000000	|150.000000|
|mean	|3.057333	|5.843333|
|std	|0.435866	|0.828066|
|min	|2.000000	|4.300000|
|25%	|2.800000	|5.100000|
|50%	|3.000000	|5.800000|
|75%	|3.300000	|6.400000|
|max	|4.400000	|7.900000|

### 함수 기반 변환
```fill100
iris['sepal_length']
iris['sepal_length'].apply(lambda x: x**2)
```

### 그룹
`iris.groupby('species').mean()`


### 데이터 Merge
- sql의 `JOIN`과 비슷

```
student_df = pd.DataFrame({
    'ID':[20240001, 20240002, 20240003],
    'Name':['kim', 'park', 'lee']
})

score_df = pd.DataFrame({
    'ID': [20240001, 20240002, 20240003],
    'Score': [90, 85, 88]
})

merged_df = pd.merge(student_df, score_df, on='ID')
merged_df
```
|	|ID	|Name	|Score|
| - | - | - | - |
|0	|20240001	|kim	|90|
|1	|20240002	|park	|85|
|2	|20240003	|lee	|88|
